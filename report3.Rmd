---
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, warning=FALSE, message=FALSE)
```


<style type="text/css">

h3 { /* Map Index */
  font-size: 16px;
  font-family: "Interstate";
  color:#C0C0C0;
  margin: 0.5em auto;
}



h4 { /* Title */
  font-size: 20px;
  font-weight: bold;
  font-family: "Interstate";
  color:#000000;
  margin: 0.4em auto;
}

h5 { /* Notes */
  font-size: 2px;
  font-family: "Interstate";
  margin: 0.01em auto;
}

h6 { /* Subtitle */
  font-size: 19px;
  font-family: "Interstate";
  color:#000000;
  margin: 0.01em auto;
}

hr { 
    margin: 0px;
    border-width: 1.5px;
    border-color: #C0C0C0;
}

</style>

```{r}

xxx<-((input$asp)/10)

yyy<-paste0(input$ogo,"px")




```

<h3> MAP `r input$fignum` <h3>
<font size = "2"> <hr> </font>
<h4> `r input$title` <h4>
<h6>`r input$subtitle` <h6>

```{r, fig.height=xxx, fig.width= 50, strip.white=TRUE}

input_data2<-input_data1()

if(is.numeric(input_data2[[input$var]])){frmat<-list(big.num.abbr = c("000 000" = 6, "billion" = 9))}else{frmat<-list(text.align = "left")}

if(input$hiak == FALSE){leftright<-"LEFT"}else{leftright<-"RIGHT"}

bmapper() + tm_shape(input_data2, projection = 2163) + tmapper() + tm_layout(
                           scale = 3.5,
                           legend.position = c(leftright,"BOTTOM"),
                           legend.outside = FALSE,
                           legend.text.size = 1,
                           legend.title.size = .0001,
                           title.position = c(leftright,"BOTTOM"),
                           title = input$legen,
                           title.size = 1,
                           legend.format = frmat,
                           fontfamily = "Interstate",
                           frame = FALSE) 



```
<h5> <span style = "color:#C0C0C0"> <font size = "2"> `r input$notes` </font> </span>  <h5>
 <hr>
 <p><p/>
<div style="position: fixed; right: 1;"> <span style = "color:#878787"> <font size = "2"> Source: `r input$source` </font> </span> </div> 
<div style="position: fixed; right: 0;">![](logo2.jpeg){width=`r yyy`} </div>



 
 
 